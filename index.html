<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0" />
  <title>双色球</title>
  <style>
    *{margin: 0;padding: 0;}
    ul{margin: 0 auto 20px; overflow: hidden;}
    ul li{float: left;list-style: none;}
    li button{
      display: inline-block; width: 35px; height: 35px; line-height: 35px;text-align: center; border: 1px solid #F00; background-color: #eee;
      margin: 7px;color: #333;border-radius: 25px;text-decoration: none;cursor: pointer;
    }
    ul:last-child li button{border-color: #1E7DDF; }
    ul li.active button{background-color: #F00; color:#fff;}
    ul:last-child li.active button{background-color: #1E7DDF;}
  </style>
</head>

<body>
  <div id="app">
    <div>
    <ul>
      <li
        is="ball-btn"
        v-for="ball in 33"
        :num="ball"
        :key="ball"
        :balls="myBalls"
        :rball="redBall"
        type="blue"
        v-on:select-ball="onSelectBall"
      ></li>
    </ul>
    <ul>
      <li
        is="ball-btn"
        v-for="ball in 16"
        :key="ball"
        type="red"
        :num="ball"
        :balls="myBalls"
        :rball="redBall"
        v-on:select-ball="onSelectBall"
      ></li>
    </ul>
    </div>
    <p v-for="(r,idx) in resultArr">{{priceName[idx]+": "+r+" 次"}}</p>   
  </div>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
  <script src="./data.js"></script>
  <script>
    Vue.component('ball-btn', {
      props:['type','num','balls','rball'],
      data: function () {
        return {
          oldBtn:undefined,
          selected: false
        }
      },
      methods: {
        selectBall:function(num,e){
          if (this.type==="blue"){
            var ol = this.balls.length;
            this.$emit('select-ball',num);
            if(ol !== this.balls.length){
              this.selected = !this.selected;
            }
          }else{
            this.$emit('select-ball',num,this.type);        
          }
        }
      },
      computed:{
        liActive:function(){
          if(this.type==="blue"){
            if(this.selected){
              return 'active';
            }
          }else{
            return (this.rball!==this.num) ? '':'active';
          }
          //type===\'blue\' ? { active: selected } : (resultNum === index? active : null)
        }
      },
      template: '<li :class="liActive" @click="selectBall(num,$event)"><button>{{num}}</button></li>'
    })

    new Vue({
      el:'#app',
      data:{
        myBalls:[],
        redBall:'',
        priceName:["一等奖","二等奖","三等奖","四等奖","五等奖","六等奖"]
      },
      methods: {
        onSelectBall: function (num,type) {
          if(type==="red"){
            this.redBall = (this.redBall === num)?'':num;
          }else{
            var ol = this.myBalls.length;
            _.pull(this.myBalls,num)
            if(ol === this.myBalls.length && this.myBalls.length<6){
              this.myBalls.push(num);
            };
            this.myBalls.sort(function (m, n) {
              return m-n; // 正序
            });
          }          
        }
      },

      computed:{
        resultArr:function(){
          var arr=[];
          for(var i=0;i<6;i++){
            if(this.myBalls[i]){
              arr[i] = this.myBalls[i]
            }else{
              arr[i] = '';
            }
          }
          arr[6]=this.redBall;
          
          return checkCount(arr);
        }
      }
    })

   //exit();

    //var myBalls = ["06","12","14","20","22","24","09"];
    //checkCount(myBalls);

    function checkCount(my){
      console.log(my)
      var bingos = [0,0,0,0,0,0];
      for(var i=0; i<ssqData.length;i++){
        var txt=" - ";
        var blueCount = 0;
        var redBingo = padZero(ssqData[i][7],2)===my[6];
        var redCount = redBingo?1:0;
        for(var j=1;j<ssqData[i].length-1;j++){
            for(var k=0;k<my.length-1;k++){
              if(padZero(ssqData[i][j],2)===my[k]){
                  txt+=my[k]+",";
                  blueCount++
              }
            }
        }
        if(redBingo){
          txt+=my[6]+"|";
        }
        var allCount = blueCount+redCount;
        if(allCount===7){
          bingos[0]++;
        }else if(allCount===6){
          redBingo ? bingos[2]++ : bingos[1]++;
        }/*else if(allCount===5 && allCount===4){
          bingos[8-allCount]++;
        }*/else if(allCount===5){
          bingos[3]++;
        }else if(allCount===4){
          bingos[4]++;
        }else{
          redBingo ? bingos[5]++ : null;
        }
        if(allCount>3){
          console.log(ssqData[i].toString()+txt+"==="+allCount);
        }


        // if(blueCount===6){
        //   redBingo ? bingos[0]++ : bingos[1]++;
        // }else if(blueCount===5){
        //   redBingo ? bingos[2]++ : null;
        // }
        // if(allCount>=6){

        // }
        // if(blueCount+redCount===3){
        //   console.log(ssqData[i].toString()+txt);
        // }
      }
      return bingos;

    }

    function padZero(n,l){
      return n;
      var p = '';
      for(var i=0;i<l;i++){
        p+='0';
      }
      return (p+n).slice(-2)+'';
    }

    /*var my = [4,10,14,18,28,32,15];
    var tmpArr=[];

    for(var i=0; i<ssqData.length;i++){
      var tmp = ssqData[i];
      var tmp1 = tmp.slice(1,8);
      //console.log(tmp1);
      if(checkCount(tmp1,ssqData)>2){
        var tmp2 = tmp1.splice(0,0,tmp[0])
        tmpArr.push(tmp1)
      }
    }
    for(var i=0; i<tmpArr.length;i++){
      var tmp = tmpArr[i];
      var tmp1 = tmp.slice(1,8);
      console.log(checkCount(tmp1,tmpArr));

    }


    function checkCount(my,ssqData){
      var tCount = 0;
      for(var i=0; i<ssqData.length;i++){
        var txt=" - ";
        var count = 0;
        for(var j=1;j<ssqData[i].length-1;j++){
            for(var k=0;k<my.length-1;k++){
              if(padZero(ssqData[i][j])===my[k]){
                  txt+=my[k]+",";
                  count++
              }
            }
        }
        if(padZero(ssqData[i][7])===my[6]){
            txt+=my[6]+"|";
            count++;
        }
        if(count>4){
          tCount++;
          if (ssqData.length<1000){
            console.log(ssqData[i].toString()+txt);
          }
        }
      }
      return tCount;
    }

    function padZero(n){
      return n;
      //return ('00'+n).slice(-2);
    }

    console.log(ssqData.length)*/
  </script>
</body>

</html>